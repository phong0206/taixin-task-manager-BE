create table comments (id bigint not null auto_increment, created_at timestamp not null default current_timestamp, deleted_at timestamp, updated_at timestamp not null default current_timestamp on update current_timestamp, content TEXT, task_id bigint not null, user_id bigint not null, primary key (id)) engine=InnoDB;
create table images (id bigint not null auto_increment, created_at timestamp not null default current_timestamp, deleted_at timestamp, updated_at timestamp not null default current_timestamp on update current_timestamp, filename varchar(255) not null, name varchar(255) not null, path varchar(255) not null, type enum ('COMMENT','TASK','USER') not null, comment_id bigint, project_id bigint, user_id bigint, primary key (id)) engine=InnoDB;
create table milestones (id bigint not null auto_increment, created_at timestamp not null default current_timestamp, deleted_at timestamp, updated_at timestamp not null default current_timestamp on update current_timestamp, name varchar(200) not null, project_id bigint not null, primary key (id)) engine=InnoDB;
create table notifications (id bigint not null auto_increment, created_at timestamp not null default current_timestamp, deleted_at timestamp, updated_at timestamp not null default current_timestamp on update current_timestamp, is_read bit not null, type enum ('ADD_TASK','ASSIGN_TASK','CHANGE_STATUS_TASK','COMMENT','UNASSIGNED_TASK') not null, recipient_id bigint not null, sender_id bigint not null, task_id bigint not null, primary key (id)) engine=InnoDB;
create table project_user (id bigint not null auto_increment, created_at timestamp not null default current_timestamp, deleted_at timestamp, updated_at timestamp not null default current_timestamp on update current_timestamp, project_id bigint not null, user_id bigint not null, primary key (id)) engine=InnoDB;
create table projects (id bigint not null auto_increment, created_at timestamp not null default current_timestamp, deleted_at timestamp, updated_at timestamp not null default current_timestamp on update current_timestamp, description TEXT not null, name varchar(255) not null, primary key (id)) engine=InnoDB;
create table tasks (id bigint not null auto_increment, created_at timestamp not null default current_timestamp, deleted_at timestamp, updated_at timestamp not null default current_timestamp on update current_timestamp, description TEXT, due_date datetime not null, priority varchar(100) not null, start_date datetime not null, status enum ('CANCELLED','CLOSED','IN_PROGRESS','IN_REVIEW','OPEN','RESOLVED') not null, title varchar(255) not null, assigned_to bigint not null, create_by bigint not null, milestone_id bigint not null, project_id bigint not null, primary key (id)) engine=InnoDB;
create table users (id bigint not null auto_increment, created_at timestamp not null default current_timestamp, deleted_at timestamp, updated_at timestamp not null default current_timestamp on update current_timestamp, access_token varchar(500), email varchar(255) not null, name varchar(100) not null, password varchar(255) not null, refresh_token varchar(500), role enum ('ADMIN','USER'), primary key (id)) engine=InnoDB;
alter table users add constraint UK6dotkott2kjsp8vw4d0m25fb7 unique (email);
alter table comments add constraint FKi7pp0331nbiwd2844kg78kfwb foreign key (task_id) references tasks (id);
alter table comments add constraint FK8omq0tc18jd43bu5tjh6jvraq foreign key (user_id) references users (id);
alter table images add constraint FKbe67dh6iitjghfl81dhiils4q foreign key (comment_id) references comments (id);
alter table images add constraint FK53tyvipxg9sef65gto6igoe8e foreign key (project_id) references projects (id);
alter table images add constraint FK13ljqfrfwbyvnsdhihwta8cpr foreign key (user_id) references users (id);
alter table milestones add constraint FK2a7fp7wfu0qc1pq3wiifbksge foreign key (project_id) references projects (id);
alter table notifications add constraint FKqqnsjxlwleyjbxlmm213jaj3f foreign key (recipient_id) references users (id);
alter table notifications add constraint FK13vcnq3ukas06ho1yrbc5lrb5 foreign key (sender_id) references users (id);
alter table notifications add constraint FK2ktjq1slw0ldkuy5rx8fbte2p foreign key (task_id) references tasks (id);
alter table project_user add constraint FK1c6bgkykjvnomkpds2xapx719 foreign key (project_id) references projects (id);
alter table project_user add constraint FKfscw5rga2yu389e705x9wg6kb foreign key (user_id) references users (id);
alter table tasks add constraint FK2vjo8mbre3rvpbd6e7976b54m foreign key (assigned_to) references users (id);
alter table tasks add constraint FKtmq24s4va4hq9w09hwm2wywkk foreign key (create_by) references users (id);
alter table tasks add constraint FKm11xypimt5ea052crm4k411ie foreign key (milestone_id) references milestones (id);
alter table tasks add constraint FKsfhn82y57i3k9uxww1s007acc foreign key (project_id) references projects (id);
